<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>企业营销管理分析报告</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .report-time {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #34495e;
            font-weight: 500;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
        }

        .kpi-item {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            border-left: 4px solid #3498db;
        }

        .kpi-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .kpi-label {
            color: #7f8c8d;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .kpi-trend {
            font-size: 0.8rem;
            margin-top: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
        }

        .trend-up {
            color: #27ae60;
        }

        .trend-down {
            color: #e74c3c;
        }

        .progress-container {
            margin: 20px 0;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 500;
            color: #34495e;
        }

        .progress-bar {
            background: #ecf0f1;
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.8s ease;
        }

        .progress-success { background: linear-gradient(90deg, #27ae60, #2ecc71); }
        .progress-warning { background: linear-gradient(90deg, #f39c12, #e67e22); }
        .progress-info { background: linear-gradient(90deg, #3498db, #2980b9); }

        .funnel-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 10px;
        }

        .funnel-stage {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            flex: 1;
            min-width: 120px;
            position: relative;
        }

        .funnel-stage:nth-child(2) {
            background: linear-gradient(135deg, #e67e22, #d35400);
        }

        .funnel-stage:nth-child(3) {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .funnel-stage:nth-child(4) {
            background: linear-gradient(135deg, #8e44ad, #7d3c98);
        }

        .funnel-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .funnel-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .funnel-rate {
            font-size: 0.8rem;
            margin-top: 5px;
            opacity: 0.8;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .data-table th {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .rank-badge {
            display: inline-block;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
        }

        .rank-1 { background: #e74c3c; }
        .rank-2 { background: #f39c12; }
        .rank-3 { background: #27ae60; }
        .rank-other { background: #95a5a6; }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-active { background: #d5f4e6; color: #27ae60; }
        .status-pending { background: #fef9e7; color: #f39c12; }
        .status-risk { background: #fadbd8; color: #e74c3c; }

        .chart-container {
            height: 300px;
            margin: 20px 0;
            position: relative;
        }

        .alert-section {
            background: linear-gradient(135deg, #fff5f5, #fed7d7);
            border-left: 4px solid #e53e3e;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .alert-title {
            color: #c53030;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .alert-content {
            color: #742a2a;
            line-height: 1.6;
        }

        .insight-section {
            background: linear-gradient(135deg, #f0fff4, #c6f6d5);
            border-left: 4px solid #38a169;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .insight-title {
            color: #2f855a;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .insight-content {
            color: #276749;
            line-height: 1.6;
        }

        .section-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .customer-level {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }

        .level-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .level-vip { background: #e74c3c; }
        .level-important { background: #f39c12; }
        .level-normal { background: #3498db; }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .summary-header h2 {
                font-size: 1.6rem;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .summary-card {
                padding: 20px;
            }

            .summary-icon {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }

            .summary-card-header h3 {
                font-size: 1.2rem;
            }

            .kpi-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .funnel-container {
                flex-direction: column;
            }

            .section-grid {
                grid-template-columns: 1fr;
            }
        }

        .section-divider {
            height: 2px;
            background: linear-gradient(90deg, transparent, #bdc3c7, transparent);
            margin: 40px 0;
        }

        /* 执行摘要样式 */
        .executive-summary {
            margin-bottom: 40px;
        }

        .summary-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .summary-header h2 {
            font-size: 2rem;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .summary-header p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .summary-card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 15px;
        }

        .summary-icon {
            width: 50px;
            height: 50px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .summary-card-header h3 {
            font-size: 1.4rem;
            color: #2c3e50;
            font-weight: 600;
        }

        .summary-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* 核心发现样式 */
        .finding-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            border-radius: 10px;
            font-size: 0.95rem;
        }

        .finding-item.positive {
            background: linear-gradient(135deg, #d5f4e6, #c6f6d5);
            color: #2f855a;
        }

        .finding-item.positive i {
            color: #38a169;
        }

        .finding-item.warning {
            background: linear-gradient(135deg, #fef9e7, #fbd38d);
            color: #d69e2e;
        }

        .finding-item.warning i {
            color: #ed8936;
        }

        .finding-item.critical {
            background: linear-gradient(135deg, #fed7d7, #feb2b2);
            color: #c53030;
        }

        .finding-item.critical i {
            color: #e53e3e;
        }

        /* 紧急行动项样式 */
        .action-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 15px;
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-radius: 12px;
            border-left: 4px solid #e2e8f0;
        }

        .priority-badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
            text-align: center;
            min-width: 30px;
        }

        .priority-badge.high {
            background: #e53e3e;
            color: white;
        }

        .priority-badge.medium {
            background: #ed8936;
            color: white;
        }

        .action-text {
            flex: 1;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* 战略建议样式 */
        .strategy-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #ebf8ff, #bee3f8);
            border-radius: 12px;
        }

        .strategy-number {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #3182ce, #2c5282);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .strategy-text {
            font-size: 0.9rem;
            line-height: 1.5;
            color: #2a4365;
        }

        /* 关键指标预警样式 */
        .metric-alert {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: #f7fafc;
            border-radius: 12px;
            border-left: 4px solid #e2e8f0;
        }

        .alert-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .alert-indicator.good {
            background: #38a169;
        }

        .alert-indicator.warning {
            background: #ed8936;
        }

        .alert-indicator.danger {
            background: #e53e3e;
        }

        .alert-text {
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .metric-value {
            font-weight: bold;
            color: #2d3748;
        }

        /* 明细查询样式 */
        .detail-query-section {
            margin-bottom: 30px;
        }

        .query-controls {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .query-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 15px;
        }

        .query-row:last-child {
            margin-bottom: 0;
        }

        .query-item label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #2c3e50;
        }

        .query-select, .query-input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }

        .query-select:focus, .query-input:focus {
            outline: none;
            border-color: #3498db;
        }

        .amount-range {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .amount-range input {
            flex: 1;
        }

        .amount-range span {
            color: #7f8c8d;
            font-weight: 500;
        }

        .search-btn, .export-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 10px;
        }

        .search-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .search-btn:hover {
            background: linear-gradient(135deg, #2980b9, #1f6391);
            transform: translateY(-2px);
        }

        .export-btn {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .export-btn:hover {
            background: linear-gradient(135deg, #229954, #1e7e34);
            transform: translateY(-2px);
        }

        .query-results {
            margin-top: 20px;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .results-info {
            color: #6c757d;
            font-weight: 500;
        }

        .results-pagination {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .page-btn {
            padding: 8px 15px;
            border: 1px solid #dee2e6;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .page-btn:disabled {
            background: #f8f9fa;
            color: #6c757d;
            cursor: not-allowed;
        }

        /* 原因分析样式 */
        .analysis-section {
            margin-bottom: 30px;
        }

        .analysis-tabs {
            margin-top: 20px;
        }

        .tab-buttons {
            display: flex;
            background: #f1f3f4;
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 25px;
            overflow-x: auto;
        }

        .tab-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: #6c757d;
            font-weight: 500;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .tab-btn.active {
            background: white;
            color: #2c3e50;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .tab-btn:hover:not(.active) {
            color: #495057;
        }

        .tab-content {
            display: none;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .tab-content.active {
            display: block;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }

        .analysis-item {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .analysis-item h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .reason-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .reason-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #e9ecef;
        }

        .reason-item.critical {
            background: linear-gradient(135deg, #fff5f5, #fed7d7);
            border-left-color: #e53e3e;
        }

        .reason-item.warning {
            background: linear-gradient(135deg, #fef9e7, #fbd38d);
            border-left-color: #ed8936;
        }

        .reason-item.normal {
            background: linear-gradient(135deg, #f0fff4, #c6f6d5);
            border-left-color: #38a169;
        }

        .reason-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-top: 4px;
            flex-shrink: 0;
        }

        .reason-item.critical .reason-indicator {
            background: #e53e3e;
        }

        .reason-item.warning .reason-indicator {
            background: #ed8936;
        }

        .reason-item.normal .reason-indicator {
            background: #38a169;
        }

        .reason-content {
            flex: 1;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .reason-impact {
            font-size: 0.8rem;
            font-weight: 500;
            color: #6c757d;
            white-space: nowrap;
        }

        .suggestion-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .suggestion-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #ebf8ff, #bee3f8);
            border-radius: 10px;
        }

        .suggestion-item i {
            color: #3182ce;
            font-weight: bold;
            font-size: 1.1rem;
            margin-top: 2px;
        }

        .performance-chart {
            height: 250px;
            margin: 15px 0;
        }

        .team-metrics {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .risk-matrix {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .risk-category {
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid;
        }

        .risk-category.high-risk {
            background: linear-gradient(135deg, #fff5f5, #fed7d7);
            border-left-color: #e53e3e;
        }

        .risk-category.medium-risk {
            background: linear-gradient(135deg, #fef9e7, #fbd38d);
            border-left-color: #ed8936;
        }

        .risk-category h5 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .risk-category ul {
            margin: 0;
            padding-left: 20px;
        }

        .risk-category li {
            margin-bottom: 8px;
            color: #4a5568;
        }

        .mitigation-plan {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .plan-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            border-radius: 10px;
        }

        .plan-item.urgent {
            background: linear-gradient(135deg, #fff5f5, #fed7d7);
        }

        .plan-item.important {
            background: linear-gradient(135deg, #fef9e7, #fbd38d);
        }

        .plan-item.normal {
            background: linear-gradient(135deg, #f0fff4, #c6f6d5);
        }

        .priority-label {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            color: white;
            flex-shrink: 0;
        }

        .plan-item.urgent .priority-label {
            background: #e53e3e;
        }

        .plan-item.important .priority-label {
            background: #ed8936;
        }

        .plan-item.normal .priority-label {
            background: #38a169;
        }

        .market-trends {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .trend-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .trend-positive {
            color: #27ae60;
        }

        .trend-negative {
            color: #e74c3c;
        }

        .trend-stable {
            color: #f39c12;
        }

        .opportunity-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .opportunity-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #f0fff4, #c6f6d5);
            border-radius: 10px;
        }

        .opportunity-score {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .opportunity-content {
            flex: 1;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* 综合业务框架样式 */
        .comprehensive-framework {
            margin-bottom: 30px;
        }

        .framework-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .framework-header h2 {
            color: white;
            font-size: 2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .framework-header p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
        }

        .framework-tabs {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .framework-tab-buttons {
            display: flex;
            background: #f1f3f4;
            border-radius: 15px;
            padding: 8px;
            margin-bottom: 30px;
            overflow-x: auto;
            gap: 5px;
        }

        .framework-tab-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: transparent;
            color: #6c757d;
            font-weight: 500;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 120px;
        }

        .framework-tab-btn.active {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .framework-tab-btn:hover:not(.active) {
            background: #e9ecef;
            color: #495057;
        }

        .framework-tab-content {
            display: none;
        }

        .framework-tab-content.active {
            display: block;
        }

        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }

        .module-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .module-card:hover {
            transform: translateY(-5px);
        }

        .module-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .module-header h3 {
            color: #2c3e50;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .product-performance {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .product-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 15px;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .product-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .product-name {
            font-weight: 600;
            color: #2c3e50;
        }

        .product-category {
            font-size: 0.8rem;
            color: #7f8c8d;
            padding: 2px 8px;
            background: #ecf0f1;
            border-radius: 12px;
            width: fit-content;
        }

        .product-metrics {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3px;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #7f8c8d;
        }

        .product-revenue {
            font-size: 1.2rem;
            font-weight: bold;
            color: #27ae60;
        }

        .inventory-status {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .inventory-item {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 15px;
            align-items: center;
            padding: 15px;
            border-radius: 10px;
        }

        .inventory-item.normal {
            background: linear-gradient(135deg, #d5f4e6, #c6f6d5);
        }

        .inventory-item.warning {
            background: linear-gradient(135deg, #fef9e7, #fbd38d);
        }

        .inventory-item.critical {
            background: linear-gradient(135deg, #fed7d7, #feb2b2);
        }

        .inventory-product {
            font-weight: 500;
            color: #2c3e50;
        }

        .inventory-level {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .inventory-quantity {
            font-weight: bold;
            color: #2c3e50;
        }

        .performance-chart-container {
            height: 200px;
            margin: 15px 0;
        }

        .skill-analysis {
            padding: 15px 0;
        }

        .skill-category h4 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .skill-items {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .skill-item {
            display: grid;
            grid-template-columns: 80px 1fr 50px;
            gap: 15px;
            align-items: center;
        }

        .skill-bar {
            background: #e9ecef;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }

        .skill-progress {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2980b9);
            border-radius: 4px;
            transition: width 0.8s ease;
        }

        .customer-lifecycle {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
        }

        .lifecycle-stage {
            text-align: center;
            padding: 20px 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .stage-header {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 8px;
        }

        .stage-count {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stage-trend {
            font-size: 0.8rem;
            color: #27ae60;
            font-weight: 500;
        }

        .satisfaction-metrics {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .satisfaction-score {
            text-align: center;
            padding: 25px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .score-value {
            font-size: 3rem;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 5px;
        }

        .score-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        .satisfaction-breakdown {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .contract-status {
            padding: 15px 0;
        }

        .status-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
        }

        .status-item {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .status-item.executing {
            background: linear-gradient(135deg, #d5f4e6, #c6f6d5);
        }

        .status-item.completed {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
        }

        .status-item.pending {
            background: linear-gradient(135deg, #fef9e7, #fbd38d);
        }

        .status-count {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .status-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .status-percentage {
            font-size: 0.8rem;
            color: #6c757d;
            font-weight: 500;
        }

        .contract-alerts {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .alert-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .alert-item.urgent {
            background: linear-gradient(135deg, #fed7d7, #feb2b2);
        }

        .alert-item.warning {
            background: linear-gradient(135deg, #fef9e7, #fbd38d);
        }

        .alert-item.normal {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
        }

        .alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .alert-item.urgent .alert-icon {
            background: #e53e3e;
            color: white;
        }

        .alert-item.warning .alert-icon {
            background: #ed8936;
            color: white;
        }

        .alert-item.normal .alert-icon {
            background: #3182ce;
            color: white;
        }

        .alert-content {
            flex: 1;
        }

        .alert-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .alert-detail {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .site-overview, .team-management {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }

        .site-placeholder, .team-placeholder {
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 15px;
            border: 2px dashed #dee2e6;
            max-width: 400px;
            width: 100%;
        }

        .site-placeholder i, .team-placeholder i {
            font-size: 3rem;
            color: #dee2e6;
            margin-bottom: 15px;
        }

        .site-placeholder h4, .team-placeholder h4 {
            color: #6c757d;
            margin-bottom: 10px;
        }

        .site-placeholder p, .team-placeholder p {
            color: #adb5bd;
            margin-bottom: 20px;
        }

        .config-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .config-btn:hover {
            background: linear-gradient(135deg, #2980b9, #1f6391);
            transform: translateY(-2px);
        }

        .placeholder-metrics {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .placeholder-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .placeholder-item span:first-child {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .placeholder-item span:last-child {
            color: #adb5bd;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 报告头部 -->
        <div class="header">
            <h1>
                <i class="fas fa-chart-line"></i>
                企业营销管理分析报告
            </h1>
            <p class="subtitle">基于销帮帮(XBB)系统数据的综合营销分析与决策支持</p>
            <div class="report-time">
                <i class="fas fa-calendar-alt"></i>
                <span>报告周期：2025年1月1日 - 2025年1月31日</span>
                <span style="margin-left: 20px;">
                    <i class="fas fa-clock"></i>
                    生成时间：2025年1月31日 09:30
                </span>
            </div>
        </div>

        <!-- 执行摘要与决策建议 -->
        <div class="executive-summary">
            <div class="summary-header">
                <h2><i class="fas fa-lightbulb"></i> 执行摘要与决策建议</h2>
                <p>基于数据分析的核心发现与管理建议</p>
            </div>
            
            <div class="summary-grid">
                <!-- 核心发现 -->
                <div class="summary-card findings-card">
                    <div class="summary-card-header">
                        <div class="summary-icon" style="background: linear-gradient(135deg, #2ecc71, #27ae60);">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3>核心发现</h3>
                    </div>
                    <div class="summary-content">
                        <div class="finding-item positive">
                            <i class="fas fa-check-circle"></i>
                            <span>销售转化率7.1%超行业平均水平42%</span>
                        </div>
                        <div class="finding-item positive">
                            <i class="fas fa-check-circle"></i>
                            <span>月度目标完成81.9%，预计提前完成</span>
                        </div>
                        <div class="finding-item warning">
                            <i class="fas fa-exclamation-circle"></i>
                            <span>3家重点客户存在流失风险</span>
                        </div>
                        <div class="finding-item critical">
                            <i class="fas fa-times-circle"></i>
                            <span>656万应收账款需重点关注</span>
                        </div>
                    </div>
                </div>

                <!-- 紧急行动项 -->
                <div class="summary-card action-card">
                    <div class="summary-card-header">
                        <div class="summary-icon" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <h3>紧急行动项</h3>
                    </div>
                    <div class="summary-content">
                        <div class="action-item high-priority">
                            <div class="priority-badge high">高</div>
                            <div class="action-text">
                                <strong>华润集团</strong> - 30天未跟进，立即安排张经理上门拜访
                            </div>
                        </div>
                        <div class="action-item medium-priority">
                            <div class="priority-badge medium">中</div>
                            <div class="action-text">
                                <strong>万科地产</strong> - 合同即将到期，启动续约谈判
                            </div>
                        </div>
                        <div class="action-item medium-priority">
                            <div class="priority-badge medium">中</div>
                            <div class="action-text">
                                <strong>回款计划</strong> - 制定656万未收款分阶段回收方案
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 战略建议 -->
                <div class="summary-card strategy-card">
                    <div class="summary-card-header">
                        <div class="summary-icon" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                            <i class="fas fa-chess"></i>
                        </div>
                        <h3>战略建议</h3>
                    </div>
                    <div class="summary-content">
                        <div class="strategy-item">
                            <div class="strategy-number">1</div>
                            <div class="strategy-text">
                                <strong>优化销售漏斗</strong><br>
                                提升线索到机会26%转化率，重点加强需求挖掘
                            </div>
                        </div>
                        <div class="strategy-item">
                            <div class="strategy-number">2</div>
                            <div class="strategy-text">
                                <strong>客户分级管理</strong><br>
                                建立VIP客户专属服务体系，提升客户价值
                            </div>
                        </div>
                        <div class="strategy-item">
                            <div class="strategy-number">3</div>
                            <div class="strategy-text">
                                <strong>团队能力建设</strong><br>
                                针对业绩差距大的销售人员进行专项培训
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 关键指标预警 -->
                <div class="summary-card metrics-card">
                    <div class="summary-card-header">
                        <div class="summary-icon" style="background: linear-gradient(135deg, #f39c12, #e67e22);">
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                        <h3>关键指标预警</h3>
                    </div>
                    <div class="summary-content">
                        <div class="metric-alert warning">
                            <div class="alert-indicator warning"></div>
                            <div class="alert-text">
                                <strong>回款率</strong><br>
                                <span class="metric-value">65.3%</span> 需要关注
                            </div>
                        </div>
                        <div class="metric-alert danger">
                            <div class="alert-indicator danger"></div>
                            <div class="alert-text">
                                <strong>客户风险</strong><br>
                                <span class="metric-value">3家</span> 高风险客户
                            </div>
                        </div>
                        <div class="metric-alert warning">
                            <div class="alert-indicator warning"></div>
                            <div class="alert-text">
                                <strong>新客户获取</strong><br>
                                <span class="metric-value">67/80</span> 低于目标
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 核心KPI仪表板 -->
        <div class="dashboard">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                            <i class="fas fa-bullseye"></i>
                        </div>
                        营销核心指标
                    </div>
                </div>
                <div class="kpi-grid">
                    <div class="kpi-item">
                        <div class="kpi-value">1,247</div>
                        <div class="kpi-label">销售线索</div>
                        <div class="kpi-trend trend-up">
                            <i class="fas fa-arrow-up"></i> +15.2%
                        </div>
                    </div>
                    <div class="kpi-item">
                        <div class="kpi-value">324</div>
                        <div class="kpi-label">销售机会</div>
                        <div class="kpi-trend trend-up">
                            <i class="fas fa-arrow-up"></i> +8.7%
                        </div>
                    </div>
                    <div class="kpi-item">
                        <div class="kpi-value">89</div>
                        <div class="kpi-label">成交合同</div>
                        <div class="kpi-trend trend-up">
                            <i class="fas fa-arrow-up"></i> +12.5%
                        </div>
                    </div>
                    <div class="kpi-item">
                        <div class="kpi-value" style="font-size: 1.6rem;">2,456万</div>
                        <div class="kpi-label">合同金额</div>
                        <div class="kpi-trend trend-up">
                            <i class="fas fa-arrow-up"></i> +18.3%
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon" style="background: linear-gradient(135deg, #27ae60, #229954);">
                            <i class="fas fa-target"></i>
                        </div>
                        目标达成情况
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>月度销售目标</span>
                        <span>2,456万 / 3,000万 (81.9%)</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill progress-success" style="width: 81.9%"></div>
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>新客户获取目标</span>
                        <span>67 / 80 (83.8%)</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill progress-warning" style="width: 83.8%"></div>
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>客户跟进目标</span>
                        <span>1,247 / 1,200 (103.9%)</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill progress-info" style="width: 100%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 销售漏斗分析 -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
                        <i class="fas fa-filter"></i>
                    </div>
                    销售漏斗转化分析
                </div>
            </div>
            <div class="funnel-container">
                <div class="funnel-stage">
                    <div class="funnel-value">1,247</div>
                    <div class="funnel-label">销售线索</div>
                    <div class="funnel-rate">基数 100%</div>
                </div>
                <div class="funnel-stage">
                    <div class="funnel-value">324</div>
                    <div class="funnel-label">销售机会</div>
                    <div class="funnel-rate">转化率 26.0%</div>
                </div>
                <div class="funnel-stage">
                    <div class="funnel-value">156</div>
                    <div class="funnel-label">报价阶段</div>
                    <div class="funnel-rate">转化率 48.1%</div>
                </div>
                <div class="funnel-stage">
                    <div class="funnel-value">89</div>
                    <div class="funnel-label">成交合同</div>
                    <div class="funnel-rate">转化率 57.1%</div>
                </div>
            </div>
            <div class="insight-section">
                <div class="insight-title">
                    <i class="fas fa-lightbulb"></i>
                    转化分析洞察
                </div>
                <div class="insight-content">
                    • 整体线索到成交转化率为7.1%，高于行业平均水平5.2%<br>
                    • 机会到报价转化率48.1%需要提升，建议加强客户需求挖掘<br>
                    • 报价到成交转化率57.1%表现优秀，说明报价策略有效
                </div>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- 销售团队与客户分析 -->
        <div class="section-grid">
            <!-- 销售团队分析 -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon" style="background: linear-gradient(135deg, #e67e22, #d35400);">
                            <i class="fas fa-users"></i>
                        </div>
                        销售团队表现分析
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>排名</th>
                                <th>销售人员</th>
                                <th>跟进客户</th>
                                <th>成交合同</th>
                                <th>合同金额(万)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="rank-badge rank-1">1</span></td>
                                <td>张经理</td>
                                <td>89</td>
                                <td>18</td>
                                <td>456.8</td>
                            </tr>
                            <tr>
                                <td><span class="rank-badge rank-2">2</span></td>
                                <td>李主管</td>
                                <td>76</td>
                                <td>15</td>
                                <td>398.2</td>
                            </tr>
                            <tr>
                                <td><span class="rank-badge rank-3">3</span></td>
                                <td>王总监</td>
                                <td>68</td>
                                <td>14</td>
                                <td>367.5</td>
                            </tr>
                            <tr>
                                <td><span class="rank-badge rank-other">4</span></td>
                                <td>赵专员</td>
                                <td>58</td>
                                <td>12</td>
                                <td>298.7</td>
                            </tr>
                            <tr>
                                <td><span class="rank-badge rank-other">5</span></td>
                                <td>陈助理</td>
                                <td>52</td>
                                <td>10</td>
                                <td>245.3</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 客户分析 -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon" style="background: linear-gradient(135deg, #f39c12, #e67e22);">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        客户结构分析
                    </div>
                </div>
                <div style="margin: 20px 0;">
                    <div class="customer-level">
                        <div class="level-indicator level-vip"></div>
                        <span>VIP客户 (>100万)</span>
                        <span style="margin-left: auto; font-weight: 600;">45个 (78%贡献)</span>
                    </div>
                    <div class="customer-level">
                        <div class="level-indicator level-important"></div>
                        <span>重要客户 (50-100万)</span>
                        <span style="margin-left: auto; font-weight: 600;">89个 (18%贡献)</span>
                    </div>
                    <div class="customer-level">
                        <div class="level-indicator level-normal"></div>
                        <span>普通客户 (<50万)</span>
                        <span style="margin-left: auto; font-weight: 600;">234个 (4%贡献)</span>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="customerChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 重点客户风险预警 -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    重点客户风险预警
                </div>
            </div>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>客户名称</th>
                            <th>负责人</th>
                            <th>最后跟进</th>
                            <th>合同金额(万)</th>
                            <th>风险状态</th>
                            <th>建议措施</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>华润集团</td>
                            <td>张经理</td>
                            <td>30天前</td>
                            <td>280.0</td>
                            <td><span class="status-badge status-risk">高风险</span></td>
                            <td>立即上门拜访</td>
                        </tr>
                        <tr>
                            <td>万科地产</td>
                            <td>李主管</td>
                            <td>15天前</td>
                            <td>450.0</td>
                            <td><span class="status-badge status-pending">需关注</span></td>
                            <td>合同续约跟进</td>
                        </tr>
                        <tr>
                            <td>中信证券</td>
                            <td>王总监</td>
                            <td>3天前</td>
                            <td>380.0</td>
                            <td><span class="status-badge status-active">正常</span></td>
                            <td>保持定期沟通</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- 回款分析 -->
        <div class="section-grid">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon" style="background: linear-gradient(135deg, #16a085, #1abc9c);">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        应收账款分析
                    </div>
                </div>
                <div class="kpi-grid">
                    <div class="kpi-item">
                        <div class="kpi-value" style="font-size: 1.6rem;">1,890万</div>
                        <div class="kpi-label">应收总额</div>
                    </div>
                    <div class="kpi-item">
                        <div class="kpi-value" style="font-size: 1.6rem;">1,234万</div>
                        <div class="kpi-label">已收金额</div>
                    </div>
                    <div class="kpi-item">
                        <div class="kpi-value">656万</div>
                        <div class="kpi-label">未收金额</div>
                    </div>
                    <div class="kpi-item">
                        <div class="kpi-value">65.3%</div>
                        <div class="kpi-label">回款率</div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="paymentChart"></canvas>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon" style="background: linear-gradient(135deg, #34495e, #2c3e50);">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        产品销售贡献分析
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>产品类别</th>
                                <th>销售数量</th>
                                <th>销售金额(万)</th>
                                <th>贡献占比</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>工业设备</td>
                                <td>156</td>
                                <td>1,234.5</td>
                                <td>50.3%</td>
                            </tr>
                            <tr>
                                <td>技术服务</td>
                                <td>89</td>
                                <td>678.9</td>
                                <td>27.6%</td>
                            </tr>
                            <tr>
                                <td>软件系统</td>
                                <td>234</td>
                                <td>345.6</td>
                                <td>14.1%</td>
                            </tr>
                            <tr>
                                <td>配件耗材</td>
                                <td>567</td>
                                <td>197.0</td>
                                <td>8.0%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 明细查询功能 -->
        <div class="card detail-query-section">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
                        <i class="fas fa-search"></i>
                    </div>
                    明细查询
                </div>
            </div>
            
            <!-- 查询条件区域 -->
            <div class="query-controls">
                <div class="query-row">
                    <div class="query-item">
                        <label>查询类型</label>
                        <select id="queryType" class="query-select">
                            <option value="customer">客户明细</option>
                            <option value="opportunity">销售机会</option>
                            <option value="contract">合同明细</option>
                            <option value="payment">回款明细</option>
                            <option value="communication">跟进记录</option>
                        </select>
                    </div>
                    <div class="query-item">
                        <label>时间范围</label>
                        <select id="timeRange" class="query-select">
                            <option value="current_month">本月</option>
                            <option value="last_month">上月</option>
                            <option value="current_quarter">本季度</option>
                            <option value="current_year">本年度</option>
                            <option value="custom">自定义</option>
                        </select>
                    </div>
                    <div class="query-item">
                        <label>负责人员</label>
                        <select id="salesPerson" class="query-select">
                            <option value="">全部</option>
                            <option value="张经理">张经理</option>
                            <option value="李主管">李主管</option>
                            <option value="王总监">王总监</option>
                            <option value="赵专员">赵专员</option>
                            <option value="陈助理">陈助理</option>
                        </select>
                    </div>
                    <div class="query-item">
                        <label>状态筛选</label>
                        <select id="statusFilter" class="query-select">
                            <option value="">全部状态</option>
                            <option value="active">活跃</option>
                            <option value="pending">待跟进</option>
                            <option value="completed">已完成</option>
                            <option value="risk">风险</option>
                        </select>
                    </div>
                    <div class="query-item">
                        <button id="searchBtn" class="search-btn">
                            <i class="fas fa-search"></i> 查询
                        </button>
                        <button id="exportBtn" class="export-btn">
                            <i class="fas fa-download"></i> 导出
                        </button>
                    </div>
                </div>
                <div class="query-row">
                    <div class="query-item">
                        <label>关键词搜索</label>
                        <input type="text" id="keyword" class="query-input" placeholder="输入客户名称、合同编号等关键词">
                    </div>
                    <div class="query-item">
                        <label>金额范围</label>
                        <div class="amount-range">
                            <input type="number" id="minAmount" class="query-input" placeholder="最小金额">
                            <span>至</span>
                            <input type="number" id="maxAmount" class="query-input" placeholder="最大金额">
                        </div>
                    </div>
                </div>
            </div>

            <!-- 查询结果区域 -->
            <div class="query-results">
                <div class="results-header">
                    <div class="results-info">
                        <span id="resultsCount">共找到 0 条记录</span>
                    </div>
                    <div class="results-pagination">
                        <button class="page-btn" id="prevPage">上一页</button>
                        <span id="pageInfo">第 1 页 / 共 1 页</span>
                        <button class="page-btn" id="nextPage">下一页</button>
                    </div>
                </div>
                
                <div id="queryResultsTable" class="table-container">
                    <!-- 动态生成的查询结果表格 -->
                </div>
            </div>
        </div>

        <!-- 原因分析模块 -->
        <div class="card analysis-section">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon" style="background: linear-gradient(135deg, #e67e22, #d35400);">
                        <i class="fas fa-microscope"></i>
                    </div>
                    深度原因分析
                </div>
            </div>

            <div class="analysis-tabs">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-tab="conversion">转化率分析</button>
                    <button class="tab-btn" data-tab="performance">业绩分析</button>
                    <button class="tab-btn" data-tab="risk">风险分析</button>
                    <button class="tab-btn" data-tab="market">市场分析</button>
                </div>

                <!-- 转化率分析 -->
                <div class="tab-content active" id="conversion-tab">
                    <div class="analysis-grid">
                        <div class="analysis-item">
                            <h4><i class="fas fa-chart-line"></i> 线索转化率低的原因</h4>
                            <div class="reason-list">
                                <div class="reason-item critical">
                                    <div class="reason-indicator"></div>
                                    <div class="reason-content">
                                        <strong>线索质量问题</strong><br>
                                        <span>34%的线索为无效信息，缺乏有效的线索筛选机制</span>
                                    </div>
                                    <div class="reason-impact">影响度: 高</div>
                                </div>
                                <div class="reason-item warning">
                                    <div class="reason-indicator"></div>
                                    <div class="reason-content">
                                        <strong>跟进时效性差</strong><br>
                                        <span>平均首次跟进时间为48小时，超过行业标准24小时</span>
                                    </div>
                                    <div class="reason-impact">影响度: 中</div>
                                </div>
                                <div class="reason-item normal">
                                    <div class="reason-indicator"></div>
                                    <div class="reason-content">
                                        <strong>销售技能差异</strong><br>
                                        <span>新员工转化率比资深员工低42%，需要技能培训</span>
                                    </div>
                                    <div class="reason-impact">影响度: 中</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="analysis-item">
                            <h4><i class="fas fa-target"></i> 改善建议</h4>
                            <div class="suggestion-list">
                                <div class="suggestion-item">
                                    <i class="fas fa-1"></i>
                                    <div>
                                        <strong>建立线索评分体系</strong><br>
                                        根据客户规模、需求匹配度等维度进行评分筛选
                                    </div>
                                </div>
                                <div class="suggestion-item">
                                    <i class="fas fa-2"></i>
                                    <div>
                                        <strong>优化跟进流程</strong><br>
                                        设置自动提醒，确保24小时内完成首次跟进
                                    </div>
                                </div>
                                <div class="suggestion-item">
                                    <i class="fas fa-3"></i>
                                    <div>
                                        <strong>加强培训体系</strong><br>
                                        针对新员工制定专项培训计划，提升销售技能
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 业绩分析 -->
                <div class="tab-content" id="performance-tab">
                    <div class="analysis-grid">
                        <div class="analysis-item">
                            <h4><i class="fas fa-trophy"></i> 业绩差异分析</h4>
                            <div class="performance-chart">
                                <canvas id="performanceAnalysisChart"></canvas>
                            </div>
                        </div>
                        <div class="analysis-item">
                            <h4><i class="fas fa-users"></i> 团队效能分析</h4>
                            <div class="team-metrics">
                                <div class="metric-row">
                                    <span>平均客户跟进周期</span>
                                    <span class="metric-value">15.3天</span>
                                    <span class="metric-trend trend-up">+2.1天</span>
                                </div>
                                <div class="metric-row">
                                    <span>平均成单周期</span>
                                    <span class="metric-value">45.7天</span>
                                    <span class="metric-trend trend-down">-3.2天</span>
                                </div>
                                <div class="metric-row">
                                    <span>客户满意度</span>
                                    <span class="metric-value">87.5%</span>
                                    <span class="metric-trend trend-up">+1.8%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 风险分析 -->
                <div class="tab-content" id="risk-tab">
                    <div class="analysis-grid">
                        <div class="analysis-item">
                            <h4><i class="fas fa-exclamation-triangle"></i> 潜在风险识别</h4>
                            <div class="risk-matrix">
                                <div class="risk-category high-risk">
                                    <h5>高风险项目</h5>
                                    <ul>
                                        <li>华润集团 - 30天未跟进，合同金额280万</li>
                                        <li>应收账款超期 - 126万未按期回款</li>
                                        <li>产品库存积压 - 工业设备库存过多</li>
                                    </ul>
                                </div>
                                <div class="risk-category medium-risk">
                                    <h5>中等风险项目</h5>
                                    <ul>
                                        <li>万科地产 - 合同即将到期需续约</li>
                                        <li>新客户获取不足 - 低于目标16.25%</li>
                                        <li>销售团队流失率上升</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="analysis-item">
                            <h4><i class="fas fa-shield-alt"></i> 风险缓解措施</h4>
                            <div class="mitigation-plan">
                                <div class="plan-item urgent">
                                    <span class="priority-label">紧急</span>
                                    <div>立即安排高风险客户专人对接，72小时内完成回访</div>
                                </div>
                                <div class="plan-item important">
                                    <span class="priority-label">重要</span>
                                    <div>制定应收账款分阶段回收计划，设置专门催收小组</div>
                                </div>
                                <div class="plan-item normal">
                                    <span class="priority-label">常规</span>
                                    <div>优化库存管理，调整产品推广策略</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 市场分析 -->
                <div class="tab-content" id="market-tab">
                    <div class="analysis-grid">
                        <div class="analysis-item">
                            <h4><i class="fas fa-chart-area"></i> 市场趋势分析</h4>
                            <div class="market-trends">
                                <div class="trend-item">
                                    <i class="fas fa-arrow-up trend-positive"></i>
                                    <div>
                                        <strong>工业自动化需求增长</strong><br>
                                        预计Q2需求增长25%，建议加大产品推广
                                    </div>
                                </div>
                                <div class="trend-item">
                                    <i class="fas fa-arrow-down trend-negative"></i>
                                    <div>
                                        <strong>传统制造业订单下滑</strong><br>
                                        受经济影响，订单量下降15%
                                    </div>
                                </div>
                                <div class="trend-item">
                                    <i class="fas fa-arrow-right trend-stable"></i>
                                    <div>
                                        <strong>服务型业务稳定增长</strong><br>
                                        技术服务需求保持稳定，客户黏性强
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="analysis-item">
                            <h4><i class="fas fa-bullseye"></i> 市场机会</h4>
                            <div class="opportunity-list">
                                <div class="opportunity-item">
                                    <div class="opportunity-score">85</div>
                                    <div class="opportunity-content">
                                        <strong>新能源行业客户</strong><br>
                                        <span>市场热度高，竞争相对较少，建议重点开发</span>
                                    </div>
                                </div>
                                <div class="opportunity-item">
                                    <div class="opportunity-score">72</div>
                                    <div class="opportunity-content">
                                        <strong>智能制造升级需求</strong><br>
                                        <span>传统制造业数字化转型，存在大量升级需求</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- 综合业务模块框架 -->
        <div class="comprehensive-framework">
            <div class="framework-header">
                <h2><i class="fas fa-cubes"></i> 综合业务分析框架</h2>
                <p>产品、员工、客户、合同、站点的全方位数据分析</p>
            </div>

            <div class="framework-tabs">
                <div class="framework-tab-buttons">
                    <button class="framework-tab-btn active" data-framework-tab="product">
                        <i class="fas fa-box"></i> 产品分析
                    </button>
                    <button class="framework-tab-btn" data-framework-tab="employee">
                        <i class="fas fa-user-tie"></i> 员工分析
                    </button>
                    <button class="framework-tab-btn" data-framework-tab="customer">
                        <i class="fas fa-users"></i> 客户分析
                    </button>
                    <button class="framework-tab-btn" data-framework-tab="contract">
                        <i class="fas fa-file-contract"></i> 合同分析
                    </button>
                    <button class="framework-tab-btn" data-framework-tab="site">
                        <i class="fas fa-building"></i> 班组/云站点
                    </button>
                </div>

                <!-- 产品分析模块 -->
                <div class="framework-tab-content active" id="product-framework">
                    <div class="module-grid">
                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-chart-bar"></i> 产品销售表现</h3>
                            </div>
                            <div class="product-performance">
                                <div class="product-item">
                                    <div class="product-info">
                                        <span class="product-name">工业设备A系列</span>
                                        <span class="product-category">核心产品</span>
                                    </div>
                                    <div class="product-metrics">
                                        <span class="metric-label">销量</span>
                                        <span class="metric-value">156台</span>
                                        <span class="metric-trend trend-up">+23%</span>
                                    </div>
                                    <div class="product-revenue">1,234万</div>
                                </div>
                                <div class="product-item">
                                    <div class="product-info">
                                        <span class="product-name">技术服务包</span>
                                        <span class="product-category">增值服务</span>
                                    </div>
                                    <div class="product-metrics">
                                        <span class="metric-label">订单</span>
                                        <span class="metric-value">89个</span>
                                        <span class="metric-trend trend-up">+15%</span>
                                    </div>
                                    <div class="product-revenue">679万</div>
                                </div>
                                <div class="product-item">
                                    <div class="product-info">
                                        <span class="product-name">软件系统</span>
                                        <span class="product-category">数字化产品</span>
                                    </div>
                                    <div class="product-metrics">
                                        <span class="metric-label">授权</span>
                                        <span class="metric-value">234个</span>
                                        <span class="metric-trend trend-down">-8%</span>
                                    </div>
                                    <div class="product-revenue">346万</div>
                                </div>
                            </div>
                        </div>

                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-warehouse"></i> 库存与供应链</h3>
                            </div>
                            <div class="inventory-status">
                                <div class="inventory-item normal">
                                    <span class="inventory-product">工业设备A系列</span>
                                    <span class="inventory-level">库存充足</span>
                                    <span class="inventory-quantity">45台</span>
                                </div>
                                <div class="inventory-item warning">
                                    <span class="inventory-product">配件耗材</span>
                                    <span class="inventory-level">库存偏低</span>
                                    <span class="inventory-quantity">12套</span>
                                </div>
                                <div class="inventory-item critical">
                                    <span class="inventory-product">软件系统</span>
                                    <span class="inventory-level">需要补充</span>
                                    <span class="inventory-quantity">3个许可</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 员工分析模块 -->
                <div class="framework-tab-content" id="employee-framework">
                    <div class="module-grid">
                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-chart-line"></i> 员工绩效分析</h3>
                            </div>
                            <div class="employee-performance">
                                <div class="performance-chart-container">
                                    <canvas id="employeePerformanceChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-graduation-cap"></i> 能力发展分析</h3>
                            </div>
                            <div class="skill-analysis">
                                <div class="skill-category">
                                    <h4>销售技能评分</h4>
                                    <div class="skill-items">
                                        <div class="skill-item">
                                            <span>客户沟通</span>
                                            <div class="skill-bar">
                                                <div class="skill-progress" style="width: 85%"></div>
                                            </div>
                                            <span>85%</span>
                                        </div>
                                        <div class="skill-item">
                                            <span>需求挖掘</span>
                                            <div class="skill-bar">
                                                <div class="skill-progress" style="width: 72%"></div>
                                            </div>
                                            <span>72%</span>
                                        </div>
                                        <div class="skill-item">
                                            <span>成交技巧</span>
                                            <div class="skill-bar">
                                                <div class="skill-progress" style="width: 78%"></div>
                                            </div>
                                            <span>78%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 客户分析模块 -->
                <div class="framework-tab-content" id="customer-framework">
                    <div class="module-grid">
                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-user-circle"></i> 客户生命周期</h3>
                            </div>
                            <div class="customer-lifecycle">
                                <div class="lifecycle-stage">
                                    <div class="stage-header">潜在客户</div>
                                    <div class="stage-count">456个</div>
                                    <div class="stage-trend">+12%</div>
                                </div>
                                <div class="lifecycle-stage">
                                    <div class="stage-header">意向客户</div>
                                    <div class="stage-count">189个</div>
                                    <div class="stage-trend">+8%</div>
                                </div>
                                <div class="lifecycle-stage">
                                    <div class="stage-header">成交客户</div>
                                    <div class="stage-count">67个</div>
                                    <div class="stage-trend">+15%</div>
                                </div>
                                <div class="lifecycle-stage">
                                    <div class="stage-header">忠诚客户</div>
                                    <div class="stage-count">23个</div>
                                    <div class="stage-trend">+5%</div>
                                </div>
                            </div>
                        </div>

                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-heart"></i> 客户满意度</h3>
                            </div>
                            <div class="satisfaction-metrics">
                                <div class="satisfaction-score">
                                    <div class="score-value">87.5</div>
                                    <div class="score-label">综合满意度</div>
                                </div>
                                <div class="satisfaction-breakdown">
                                    <div class="breakdown-item">
                                        <span>产品质量</span>
                                        <span>92%</span>
                                    </div>
                                    <div class="breakdown-item">
                                        <span>服务态度</span>
                                        <span>89%</span>
                                    </div>
                                    <div class="breakdown-item">
                                        <span>响应速度</span>
                                        <span>81%</span>
                                    </div>
                                    <div class="breakdown-item">
                                        <span>售后服务</span>
                                        <span>85%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 合同分析模块 -->
                <div class="framework-tab-content" id="contract-framework">
                    <div class="module-grid">
                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-file-contract"></i> 合同执行状态</h3>
                            </div>
                            <div class="contract-status">
                                <div class="status-overview">
                                    <div class="status-item executing">
                                        <div class="status-count">156</div>
                                        <div class="status-label">执行中</div>
                                        <div class="status-percentage">65%</div>
                                    </div>
                                    <div class="status-item completed">
                                        <div class="status-count">89</div>
                                        <div class="status-label">已完成</div>
                                        <div class="status-percentage">27%</div>
                                    </div>
                                    <div class="status-item pending">
                                        <div class="status-count">23</div>
                                        <div class="status-label">待签署</div>
                                        <div class="status-percentage">8%</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-calendar-check"></i> 合同到期预警</h3>
                            </div>
                            <div class="contract-alerts">
                                <div class="alert-item urgent">
                                    <div class="alert-icon"><i class="fas fa-exclamation-circle"></i></div>
                                    <div class="alert-content">
                                        <div class="alert-title">万科地产 - 服务合同</div>
                                        <div class="alert-detail">7天后到期，金额450万</div>
                                    </div>
                                </div>
                                <div class="alert-item warning">
                                    <div class="alert-icon"><i class="fas fa-clock"></i></div>
                                    <div class="alert-content">
                                        <div class="alert-title">中信证券 - 软件授权</div>
                                        <div class="alert-detail">15天后到期，金额280万</div>
                                    </div>
                                </div>
                                <div class="alert-item normal">
                                    <div class="alert-icon"><i class="fas fa-info-circle"></i></div>
                                    <div class="alert-content">
                                        <div class="alert-title">招商银行 - 设备采购</div>
                                        <div class="alert-detail">30天后到期，金额180万</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 班组/云站点模块 -->
                <div class="framework-tab-content" id="site-framework">
                    <div class="module-grid">
                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-building"></i> 站点分布概览</h3>
                            </div>
                            <div class="site-overview">
                                <div class="site-placeholder">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <h4>站点数据待配置</h4>
                                    <p>当前系统中暂无班组/云站点数据</p>
                                    <button class="config-btn">配置站点信息</button>
                                </div>
                            </div>
                        </div>

                        <div class="module-card">
                            <div class="module-header">
                                <h3><i class="fas fa-users-cog"></i> 班组管理</h3>
                            </div>
                            <div class="team-management">
                                <div class="team-placeholder">
                                    <i class="fas fa-user-friends"></i>
                                    <h4>班组信息待完善</h4>
                                    <p>建议建立班组架构和绩效考核体系</p>
                                    <div class="placeholder-metrics">
                                        <div class="placeholder-item">
                                            <span>班组数量</span>
                                            <span>--</span>
                                        </div>
                                        <div class="placeholder-item">
                                            <span>人员配置</span>
                                            <span>--</span>
                                        </div>
                                        <div class="placeholder-item">
                                            <span>效率指标</span>
                                            <span>--</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- 回款分析 -->
        <div class="section-grid">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon" style="background: linear-gradient(135deg, #16a085, #1abc9c);">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        应收账款分析
                    </div>
                </div>
                <div class="kpi-grid">
                    <div class="kpi-item">
                        <div class="kpi-value" style="font-size: 1.6rem;">1,890万</div>
                        <div class="kpi-label">应收总额</div>
                    </div>
                    <div class="kpi-item">
                        <div class="kpi-value" style="font-size: 1.6rem;">1,234万</div>
                        <div class="kpi-label">已收金额</div>
                    </div>
                    <div class="kpi-item">
                        <div class="kpi-value">656万</div>
                        <div class="kpi-label">未收金额</div>
                    </div>
                    <div class="kpi-item">
                        <div class="kpi-value">65.3%</div>
                        <div class="kpi-label">回款率</div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="paymentChart"></canvas>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon" style="background: linear-gradient(135deg, #34495e, #2c3e50);">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        产品销售贡献分析
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>产品类别</th>
                                <th>销售数量</th>
                                <th>销售金额(万)</th>
                                <th>贡献占比</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>工业设备</td>
                                <td>156</td>
                                <td>1,234.5</td>
                                <td>50.3%</td>
                            </tr>
                            <tr>
                                <td>技术服务</td>
                                <td>89</td>
                                <td>678.9</td>
                                <td>27.6%</td>
                            </tr>
                            <tr>
                                <td>软件系统</td>
                                <td>234</td>
                                <td>345.6</td>
                                <td>14.1%</td>
                            </tr>
                            <tr>
                                <td>配件耗材</td>
                                <td>567</td>
                                <td>197.0</td>
                                <td>8.0%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 客户结构饼图
        const customerCtx = document.getElementById('customerChart').getContext('2d');
        new Chart(customerCtx, {
            type: 'doughnut',
            data: {
                labels: ['VIP客户', '重要客户', '普通客户'],
                datasets: [{
                    data: [45, 89, 234],
                    backgroundColor: [
                        '#e74c3c',
                        '#f39c12',
                        '#3498db'
                    ],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });

        // 应收账款趋势图
        const paymentCtx = document.getElementById('paymentChart').getContext('2d');
        new Chart(paymentCtx, {
            type: 'line',
            data: {
                labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                datasets: [{
                    label: '应收金额',
                    data: [800, 950, 1100, 1300, 1600, 1890],
                    borderColor: '#3498db',
                    backgroundColor: 'rgba(52, 152, 219, 0.1)',
                    tension: 0.4,
                    fill: true
                }, {
                    label: '已收金额',
                    data: [600, 720, 850, 980, 1150, 1234],
                    borderColor: '#27ae60',
                    backgroundColor: 'rgba(39, 174, 96, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return value + '万';
                            }
                        }
                    }
                }
            }
        });

        // 添加交互效果
        document.querySelectorAll('.card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });

        // 明细查询功能
        function initDetailQuery() {
            // 模拟数据
            const mockData = {
                customer: [
                    { id: 1, name: '华润集团', contact: '张总', phone: '13800138001', status: '高风险', amount: 280, lastContact: '30天前' },
                    { id: 2, name: '万科地产', contact: '李经理', phone: '13800138002', status: '需关注', amount: 450, lastContact: '15天前' },
                    { id: 3, name: '中信证券', contact: '王总监', phone: '13800138003', status: '正常', amount: 380, lastContact: '3天前' },
                    { id: 4, name: '招商银行', contact: '赵主管', phone: '13800138004', status: '正常', amount: 180, lastContact: '7天前' },
                    { id: 5, name: '平安保险', contact: '陈经理', phone: '13800138005', status: '活跃', amount: 220, lastContact: '1天前' }
                ],
                opportunity: [
                    { id: 1, title: '华润智能制造项目', customer: '华润集团', stage: '需求分析', probability: 60, amount: 280, owner: '张经理' },
                    { id: 2, title: '万科数字化改造', customer: '万科地产', stage: '方案制定', probability: 80, amount: 450, owner: '李主管' },
                    { id: 3, title: '中信系统升级', customer: '中信证券', stage: '商务谈判', probability: 90, amount: 380, owner: '王总监' }
                ],
                contract: [
                    { id: 1, name: '华润设备采购合同', customer: '华润集团', amount: 280, status: '执行中', signDate: '2024-12-01', endDate: '2025-06-01' },
                    { id: 2, name: '万科服务合同', customer: '万科地产', amount: 450, status: '即将到期', signDate: '2024-06-01', endDate: '2025-02-07' },
                    { id: 3, name: '中信软件授权合同', customer: '中信证券', amount: 380, status: '执行中', signDate: '2024-10-01', endDate: '2025-02-15' }
                ],
                payment: [
                    { id: 1, contract: '华润设备采购合同', amount: 280, received: 150, pending: 130, dueDate: '2025-03-01', status: '部分回款' },
                    { id: 2, contract: '万科服务合同', amount: 450, received: 450, pending: 0, dueDate: '2025-01-15', status: '已完成' },
                    { id: 3, contract: '中信软件授权合同', amount: 380, received: 200, pending: 180, dueDate: '2025-02-28', status: '待回款' }
                ],
                communication: [
                    { id: 1, customer: '华润集团', type: '电话沟通', content: '讨论设备安装进度', date: '2025-01-01', owner: '张经理' },
                    { id: 2, customer: '万科地产', type: '现场拜访', content: '合同续约洽谈', date: '2025-01-16', owner: '李主管' },
                    { id: 3, customer: '中信证券', type: '邮件沟通', content: '系统使用培训安排', date: '2025-01-28', owner: '王总监' }
                ]
            };

            let currentPage = 1;
            const pageSize = 10;
            let currentData = [];

            // 查询按钮事件
            const searchBtn = document.getElementById('searchBtn');
            if (searchBtn) {
                searchBtn.addEventListener('click', function() {
                    performSearch();
                });
            }

            // 导出按钮事件
            const exportBtn = document.getElementById('exportBtn');
            if (exportBtn) {
                exportBtn.addEventListener('click', function() {
                    exportData();
                });
            }

            function performSearch() {
                const queryType = document.getElementById('queryType').value;
                const salesPerson = document.getElementById('salesPerson').value;
                const statusFilter = document.getElementById('statusFilter').value;
                const keyword = document.getElementById('keyword').value;
                const minAmount = document.getElementById('minAmount').value;
                const maxAmount = document.getElementById('maxAmount').value;

                // 获取对应类型的数据
                currentData = [...mockData[queryType]];

                // 应用筛选条件
                if (salesPerson) {
                    currentData = currentData.filter(item => 
                        item.owner === salesPerson || item.contact === salesPerson
                    );
                }

                if (statusFilter) {
                    currentData = currentData.filter(item => 
                        item.status === statusFilter
                    );
                }

                if (keyword) {
                    currentData = currentData.filter(item => 
                        JSON.stringify(item).toLowerCase().includes(keyword.toLowerCase())
                    );
                }

                if (minAmount) {
                    currentData = currentData.filter(item => 
                        item.amount >= parseInt(minAmount)
                    );
                }

                if (maxAmount) {
                    currentData = currentData.filter(item => 
                        item.amount <= parseInt(maxAmount)
                    );
                }

                currentPage = 1;
                renderTable();
            }

            function renderTable() {
                const container = document.getElementById('queryResultsTable');
                const queryType = document.getElementById('queryType').value;
                
                if (!container) return;

                if (currentData.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 40px; color: #6c757d;">暂无数据</div>';
                    updatePagination();
                    return;
                }

                const startIndex = (currentPage - 1) * pageSize;
                const endIndex = Math.min(startIndex + pageSize, currentData.length);
                const pageData = currentData.slice(startIndex, endIndex);

                let tableHTML = '<table class="data-table"><thead><tr>';
                
                // 根据查询类型生成表头
                switch(queryType) {
                    case 'customer':
                        tableHTML += '<th>客户名称</th><th>联系人</th><th>电话</th><th>状态</th><th>合同金额(万)</th><th>最后跟进</th>';
                        break;
                    case 'opportunity':
                        tableHTML += '<th>项目名称</th><th>客户</th><th>阶段</th><th>成功率</th><th>预计金额(万)</th><th>负责人</th>';
                        break;
                    case 'contract':
                        tableHTML += '<th>合同名称</th><th>客户</th><th>金额(万)</th><th>状态</th><th>签署日期</th><th>到期日期</th>';
                        break;
                    case 'payment':
                        tableHTML += '<th>合同</th><th>总金额(万)</th><th>已回款(万)</th><th>待回款(万)</th><th>到期日期</th><th>状态</th>';
                        break;
                    case 'communication':
                        tableHTML += '<th>客户</th><th>沟通方式</th><th>内容</th><th>日期</th><th>负责人</th>';
                        break;
                }
                
                tableHTML += '</tr></thead><tbody>';

                // 生成表格数据
                pageData.forEach(item => {
                    tableHTML += '<tr>';
                    switch(queryType) {
                        case 'customer':
                            tableHTML += `
                                <td>${item.name}</td>
                                <td>${item.contact}</td>
                                <td>${item.phone}</td>
                                <td><span class="status-badge status-${getStatusClass(item.status)}">${item.status}</span></td>
                                <td>${item.amount}</td>
                                <td>${item.lastContact}</td>
                            `;
                            break;
                        case 'opportunity':
                            tableHTML += `
                                <td>${item.title}</td>
                                <td>${item.customer}</td>
                                <td>${item.stage}</td>
                                <td>${item.probability}%</td>
                                <td>${item.amount}</td>
                                <td>${item.owner}</td>
                            `;
                            break;
                        case 'contract':
                            tableHTML += `
                                <td>${item.name}</td>
                                <td>${item.customer}</td>
                                <td>${item.amount}</td>
                                <td><span class="status-badge status-${getStatusClass(item.status)}">${item.status}</span></td>
                                <td>${item.signDate}</td>
                                <td>${item.endDate}</td>
                            `;
                            break;
                        case 'payment':
                            tableHTML += `
                                <td>${item.contract}</td>
                                <td>${item.amount}</td>
                                <td>${item.received}</td>
                                <td>${item.pending}</td>
                                <td>${item.dueDate}</td>
                                <td><span class="status-badge status-${getStatusClass(item.status)}">${item.status}</span></td>
                            `;
                            break;
                        case 'communication':
                            tableHTML += `
                                <td>${item.customer}</td>
                                <td>${item.type}</td>
                                <td>${item.content}</td>
                                <td>${item.date}</td>
                                <td>${item.owner}</td>
                            `;
                            break;
                    }
                    tableHTML += '</tr>';
                });

                tableHTML += '</tbody></table>';
                container.innerHTML = tableHTML;
                updatePagination();
            }

            function getStatusClass(status) {
                const statusMap = {
                    '正常': 'active',
                    '活跃': 'active',
                    '已完成': 'active',
                    '需关注': 'pending',
                    '待回款': 'pending',
                    '部分回款': 'pending',
                    '即将到期': 'pending',
                    '高风险': 'risk',
                    '执行中': 'active'
                };
                return statusMap[status] || 'pending';
            }

            function updatePagination() {
                const resultsCountEl = document.getElementById('resultsCount');
                const pageInfoEl = document.getElementById('pageInfo');
                
                if (resultsCountEl) {
                    resultsCountEl.textContent = `共找到 ${currentData.length} 条记录`;
                }
                
                if (pageInfoEl) {
                    const totalPages = Math.ceil(currentData.length / pageSize);
                    pageInfoEl.textContent = `第 ${currentPage} 页 / 共 ${totalPages} 页`;
                }
            }

            function exportData() {
                const queryType = document.getElementById('queryType').value;
                const fileName = `${getQueryTypeName(queryType)}_${new Date().toISOString().split('T')[0]}.csv`;
                alert(`正在导出 ${fileName}...\n共 ${currentData.length} 条记录`);
            }

            function getQueryTypeName(type) {
                const names = {
                    'customer': '客户明细',
                    'opportunity': '销售机会',
                    'contract': '合同明细', 
                    'payment': '回款明细',
                    'communication': '跟进记录'
                };
                return names[type] || type;
            }

            // 初始化时执行一次查询
            setTimeout(() => {
                performSearch();
            }, 100);
        }

        // 原因分析标签页切换
        function initAnalysisTabs() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetTab = this.dataset.tab;
                    
                    // 移除所有活跃状态
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // 添加活跃状态
                    this.classList.add('active');
                    const targetContent = document.getElementById(targetTab + '-tab');
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                });
            });
        }

        // 综合业务框架标签页切换
        function initFrameworkTabs() {
            const frameworkTabButtons = document.querySelectorAll('.framework-tab-btn');
            const frameworkTabContents = document.querySelectorAll('.framework-tab-content');

            frameworkTabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetTab = this.dataset.frameworkTab;
                    
                    // 移除所有活跃状态
                    frameworkTabButtons.forEach(btn => btn.classList.remove('active'));
                    frameworkTabContents.forEach(content => content.classList.remove('active'));
                    
                    // 添加活跃状态
                    this.classList.add('active');
                    const targetContent = document.getElementById(targetTab + '-framework');
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                });
            });
        }

        // 创建业绩分析图表
        function createPerformanceAnalysisChart() {
            const ctx = document.getElementById('performanceAnalysisChart');
            if (!ctx) return;

            new Chart(ctx.getContext('2d'), {
                type: 'radar',
                data: {
                    labels: ['销售技能', '客户关系', '产品知识', '谈判能力', '时间管理', '团队协作'],
                    datasets: [{
                        label: '张经理',
                        data: [90, 85, 95, 88, 82, 90],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.2)',
                        pointBackgroundColor: '#3498db'
                    }, {
                        label: '李主管',
                        data: [85, 90, 80, 92, 88, 85],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.2)',
                        pointBackgroundColor: '#e74c3c'
                    }, {
                        label: '团队平均',
                        data: [78, 75, 82, 80, 76, 79],
                        borderColor: '#95a5a6',
                        backgroundColor: 'rgba(149, 165, 166, 0.2)',
                        pointBackgroundColor: '#95a5a6'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    }
                }
            });
        }

        // 创建员工绩效图表
        function createEmployeePerformanceChart() {
            const ctx = document.getElementById('employeePerformanceChart');
            if (!ctx) return;

            new Chart(ctx.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['张经理', '李主管', '王总监', '赵专员', '陈助理'],
                    datasets: [{
                        label: '月度业绩(万)',
                        data: [456.8, 398.2, 367.5, 298.7, 245.3],
                        backgroundColor: [
                            'rgba(231, 76, 60, 0.8)',
                            'rgba(243, 156, 18, 0.8)',
                            'rgba(39, 174, 96, 0.8)',
                            'rgba(52, 152, 219, 0.8)',
                            'rgba(155, 89, 182, 0.8)'
                        ],
                        borderColor: [
                            '#e74c3c',
                            '#f39c12',
                            '#27ae60',
                            '#3498db',
                            '#9b59b6'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value + '万';
                                }
                            }
                        }
                    }
                }
            });
        }

        // 初始化所有功能
        setTimeout(() => {
            initDetailQuery();
            initAnalysisTabs();
            initFrameworkTabs();
            createPerformanceAnalysisChart();
            createEmployeePerformanceChart();
        }, 500);
    </script>
</body>
</html> 